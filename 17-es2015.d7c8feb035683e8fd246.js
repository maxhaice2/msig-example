(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{NSaA:function(e,t,n){"use strict";n.r(t),n.d(t,"PayPageModule",(function(){return w}));var i=n("ofXK"),r=n("3Pt+"),a=n("e8h1"),o=n("TEn/"),s=n("fXoL"),c=n("XNiG");const l=["payPalButtonContainer"];let p=(()=>{class e{constructor(e){this.zone=e}registerScript(e,t,n){const i=window[t];if(i)return void this.zone.run(()=>{n(i)});const r=document.createElement("script");r.id=this.getElemId(t),r.innerHTML="",r.onload=()=>{this.zone.run(()=>{n(window[t])})},r.src=e,r.async=!0,r.defer=!0,document.getElementsByTagName("head")[0].appendChild(r)}cleanup(e){const t=document.getElementById(this.getElemId(e));t&&t.remove()}getElemId(e){return`ngx-paypal-script-elem-${e}`}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(s.z))},e.\u0275prov=s.Hb({token:e,factory:e.\u0275fac}),e})(),d=(()=>{class e{constructor(e){this.scriptService=e,this.paypalWindowName="paypal"}registerPayPalScript(e,t){this.scriptService.registerScript(this.getUrlForConfig(e),this.paypalWindowName,t)}destroyPayPalScript(){this.scriptService.cleanup(this.paypalWindowName)}getUrlForConfig(e){const t=[{name:"client-id",value:e.clientId}];return e.currency&&t.push({name:"currency",value:e.currency}),e.commit&&t.push({name:"commit",value:e.commit}),e.vault&&t.push({name:"vault",value:e.vault}),e.extraParams&&t.push(...e.extraParams),`https://www.paypal.com/sdk/js${this.getQueryString(t)}`}getQueryString(e){let t="";for(let n=0;n<e.length;n++){const i=e[n];t+=0===n?"?":"&",t+=`${i.name}=${i.value}`}return t}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(p))},e.\u0275prov=s.Hb({token:e,factory:e.\u0275fac}),e})(),h=(()=>{class e{constructor(e,t,n){this.paypalScriptService=e,this.cdr=t,this.ngZone=n,this.registerScript=!0,this.scriptLoaded=new s.n,this.ngUnsubscribe=new c.a,this.initializePayPal=!0}set payPalButtonContainer(e){this.payPalButtonContainerElem=e}ngOnChanges(e){this.payPalButtonContainerId||(this.payPalButtonContainerId=this.generateElementId());const t=this.config;e.config.isFirstChange()&&t&&this.registerScript&&this.initPayPalScript(t,e=>{this.payPal=e,this.doPayPalCheck()}),e.config.isFirstChange()||this.reinitialize(t)}ngOnDestroy(){this.paypalScriptService.destroyPayPalScript(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngAfterViewInit(){this.doPayPalCheck()}customInit(e){this.payPal=e,this.doPayPalCheck()}reinitialize(e){if(this.config=e,this.payPal=void 0,this.paypalScriptService.destroyPayPalScript(),this.payPalButtonContainerId=this.generateElementId(),this.initializePayPal=!0,this.payPalButtonContainerElem)for(;this.payPalButtonContainerElem.nativeElement.firstChild;)this.payPalButtonContainerElem.nativeElement.removeChild(this.payPalButtonContainerElem.nativeElement.firstChild);this.cdr.detectChanges(),this.config&&(this.payPal?this.doPayPalCheck():this.initPayPalScript(this.config,e=>{this.payPal=e,this.doPayPalCheck()}))}doPayPalCheck(){this.initializePayPal&&this.config&&this.payPal&&this.payPalButtonContainerElem&&this.payPalButtonContainerElem.nativeElement.id&&(this.initializePayPal=!1,this.initPayPal(this.config,this.payPal))}initPayPalScript(e,t){this.paypalScriptService.registerPayPalScript({clientId:e.clientId,commit:e.advanced&&e.advanced.commit?e.advanced.commit:void 0,currency:e.currency,vault:e.vault,extraParams:e.advanced&&e.advanced.extraQueryParams?e.advanced.extraQueryParams:[]},e=>{this.scriptLoaded.next(e),t(e)})}generateElementId(){return`ngx-captcha-id-${(new Date).valueOf()}`}initPayPal(e,t){this.ngZone.runOutsideAngular(()=>{const n=Object.assign(Object.assign(Object.assign({style:e.style,onApprove:(t,n)=>this.ngZone.run(()=>{if(e.onApprove&&e.onApprove(t,n),e.authorizeOnServer)return e.authorizeOnServer(t,n);const i=e.onClientAuthorization;i&&n.order.capture().then(e=>{this.ngZone.run(()=>{i(e)})})}),onError:t=>{this.ngZone.run(()=>{e.onError&&e.onError(t)})},onCancel:(t,n)=>{this.ngZone.run(()=>{e.onCancel&&e.onCancel(t,n)})},onClick:(t,n)=>{this.ngZone.run(()=>{e.onClick&&e.onClick(t,n)})},onInit:(t,n)=>{this.ngZone.run(()=>{e.onInit&&e.onInit(t,n)})}},(e.createOrderOnClient||e.createOrderOnServer)&&{createOrder:(t,n)=>this.ngZone.run(()=>{if(e.createOrderOnClient&&e.createOrderOnServer)throw Error("Both 'createOrderOnClient' and 'createOrderOnServer' are defined.\n                    Please choose one or the other.");if(!e.createOrderOnClient&&!e.createOrderOnServer)throw Error("Neither 'createOrderOnClient' or 'createOrderOnServer' are defined.\n                    Please define one of these to create order.");if(e.createOrderOnClient)return n.order.create(e.createOrderOnClient(t));if(e.createOrderOnServer)return e.createOrderOnServer(t);throw Error("Invalid state for 'createOrder'.")})}),e.createSubscription&&{createSubscription:(t,n)=>this.ngZone.run(()=>{if(e.createSubscription)return e.createSubscription(t,n)})}),e.onShippingChange&&{onShippingChange:(t,n)=>this.ngZone.run(()=>{if(e.onShippingChange)return e.onShippingChange(t,n)})});t.Buttons(n).render(`#${this.payPalButtonContainerId}`)})}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(d),s.Lb(s.h),s.Lb(s.z))},e.\u0275cmp=s.Fb({type:e,selectors:[["ngx-paypal"]],viewQuery:function(e,t){var n;1&e&&s.wc(l,!0),2&e&&s.ic(n=s.Zb())&&(t.payPalButtonContainer=n.first)},inputs:{registerScript:"registerScript",config:"config"},outputs:{scriptLoaded:"scriptLoaded"},features:[s.yb],decls:2,vars:1,consts:[[3,"id"],["payPalButtonContainer",""]],template:function(e,t){1&e&&s.Mb(0,"div",0,1),2&e&&s.dc("id",t.payPalButtonContainerId)},encapsulation:2,changeDetection:0}),e})(),u=(()=>{class e{}return e.\u0275mod=s.Jb({type:e}),e.\u0275inj=s.Ib({factory:function(t){return new(t||e)},providers:[p,d],imports:[[i.b]]}),e})();var g=n("tyNb"),b=n("mrSG"),y=n("umB2"),v=n("DTUA"),P=n("tk/3");function f(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div"),s.Mb(1,"br"),s.Mb(2,"br"),s.Mb(3,"br"),s.Qb(4,"ion-item"),s.Qb(5,"ion-label"),s.rc(6,"\u0413\u043e\u0440\u043e\u0434"),s.Pb(),s.Qb(7,"ion-select",5),s.Yb("ngModelChange",(function(t){return s.lc(e),s.ac().city=t}))("ionChange",(function(){return s.lc(e),s.ac().updatePrice()})),s.Qb(8,"ion-select-option"),s.rc(9," \u0433 \u0427\u0435\u0440\u0435\u043f\u043e\u0432\u0435\u0446"),s.Pb(),s.Pb(),s.Pb(),s.Qb(10,"ion-item"),s.Qb(11,"ion-label"),s.rc(12,"\u0423\u043b\u0438\u0446\u0430, \u0434\u043e\u043c, \u043a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"),s.Pb(),s.Qb(13,"ion-input",9),s.Yb("ngModelChange",(function(t){return s.lc(e),s.ac().street=t}))("ionChange",(function(){return s.lc(e),s.ac().updatePrice()})),s.Pb(),s.Pb(),s.Pb()}if(2&e){const e=s.ac();s.Ab(7),s.dc("ngModel",e.city),s.Ab(6),s.dc("ngModel",e.street)}}function m(e,t){if(1&e){const e=s.Rb();s.Qb(0,"ion-item",10),s.Qb(1,"ion-button",11),s.Yb("click",(function(){return s.lc(e),s.ac().onClick()})),s.Qb(2,"ion-label"),s.rc(3," \u041e\u0442\u043f\u043b\u0430\u0442\u0438\u0442\u044c \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 "),s.Pb(),s.Pb(),s.Pb()}}function C(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div",12),s.Mb(1,"br"),s.Qb(2,"ngx-paypal",13),s.Yb("click",(function(){return s.lc(e),s.ac().onClick()})),s.Pb(),s.Pb()}if(2&e){const e=s.ac();s.dc("ngClass",e.typeDelivery?"":"paypalDis"),s.Ab(2),s.dc("config",e.payPalConfig)}}const O=[{path:"",component:(()=>{class e{constructor(e,t,n,i){this.authService=e,this.alertController=t,this.storage=n,this.http=i,this.delivery="",this.typeDelivery=!1,this.street="",this.region="Cherepovec",this.city="",this.storage.priceFull$.asObservable().subscribe(e=>this.price=e)}ngOnInit(){this.storage.updateAllFields(),this.initConfig(),this.storage.second.value?location.reload():this.storage.second.next(!0),this.storage.getPrice()}initConfig(){this.payPalConfig={currency:"RUB",clientId:"sb",createOrderOnClient:e=>({intent:"CAPTURE",purchase_units:[{amount:{currency_code:"RUB",value:this.price+"",breakdown:{item_total:{currency_code:"RUB",value:this.price+""}}},items:[{name:"Enterprise Subscription",quantity:"1",category:"DIGITAL_GOODS",unit_amount:{currency_code:"RUB",value:this.price+""}}]}]}),advanced:{commit:"true"},style:{label:"paypal",layout:"vertical"},onApprove:(e,t)=>{console.log("onApprove - transaction was approved, but not authorized",e,t),t.order.get().then(e=>{console.log("onApprove - you can get full order details inside onApprove: ",e)})},onClientAuthorization:e=>{console.log("onClientAuthorization - you should probably inform your server about completed transaction at this point",e)},onCancel:(e,t)=>{console.log("OnCancel",e,t)},onError:e=>{console.log("OnError",e)},onClick:(e,t)=>{console.log("onClick",e,t),this.onClick()}}}onClick(){let e="On magazine";"\u041a\u0443\u0440\u044c\u0435\u0440\u043e\u043c"!=this.delivery&&(e=this.region+","+this.city+","+this.street);for(let t=0;t<this.storage.selected$.value.length;t++){let n=this.storage.lotsFull$.value.indexOf(this.storage.selected$.value[t]);const i={idTypePaper:this.storage.selected$.value[t].split("|")[0],price:this.storage.selected$.value[t].split("|")[1],numberPhone:this.storage.selected$.value[t].split("|")[2],countPaper:this.storage.selected$.value[t].split("|")[0].split(",")[2],addres:e,blackPercentage:this.storage.selected$.value[t].split("|")[5],coloredPercentage:this.storage.selected$.value[t].split("|")[6],dateDelivery:this.storage.selected$.value[t].split("|")[7],fullNameCourier:"sample",payment:this.storage.selected$.value[t].split("|")[1],url:this.storage.selected$.value[t].split("|")[8],numberOrder:this.storage.selected$.value[t].split("|")[9],buyerId:this.storage.userId};this.http.post("https://cors-anywhere.herokuapp.com/http://3.120.184.214:8081/addOrder",i).subscribe(e=>{},e=>Object(b.a)(this,void 0,void 0,(function*(){{this.storage.setPrice(0,[]),this.storage.clear(n),this.storage.getPrice();const e=yield this.alertController.create({cssClass:"alert",header:"\u041f\u043e\u0437\u0434\u0440\u0430\u0432\u043b\u044f\u0435\u043c!",message:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d.",buttons:[{text:"\u041f\u043e\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c",role:"cancel",handler:()=>{location.reload()}}]});yield e.present()}})))}}updatePrice(){"\u041a\u0443\u0440\u044c\u0435\u0440\u043e\u043c"==this.delivery?(this.price<1e3&&(this.price+=200),this.typeDelivery=!1,""!=this.street&&""!=this.city&&""!=this.region&&(this.typeDelivery=!0)):"\u0412 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a"==this.delivery?(this.price<500&&(this.price+=50),this.price+=100,this.typeDelivery=!1,""!=this.street&&""!=this.city&&""!=this.region&&(this.typeDelivery=!0)):this.typeDelivery=!0}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(y.a),s.Lb(o.a),s.Lb(v.a),s.Lb(P.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-pay"]],decls:31,vars:5,consts:[["padding",""],[2,"text-align","center","display","block","font-size","34px"],[2,"text-align","center","display","block","font-size","32px"],["lines","none",2,"width","100%"],[2,"padding-left","4%"],["okText","\u041f\u043e\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c","cancelText","\u041e\u0442\u043c\u0435\u043d\u0430",3,"ngModel","ngModelChange","ionChange"],[4,"ngIf"],["lines","none",4,"ngIf"],["style","padding-left: 22%; padding-right: 22%;",3,"ngClass",4,"ngIf"],["type","text",3,"ngModel","ngModelChange","ionChange"],["lines","none"],[2,"width","100%",3,"click"],[2,"padding-left","22%","padding-right","22%",3,"ngClass"],[3,"config","click"]],template:function(e,t){1&e&&(s.Qb(0,"ion-content",0),s.Mb(1,"br"),s.Mb(2,"br"),s.Mb(3,"br"),s.Mb(4,"br"),s.Qb(5,"ion-label",1),s.Qb(6,"strong"),s.rc(7,"\u041a \u043e\u043f\u043b\u0430\u0442\u0435"),s.Pb(),s.Mb(8,"br"),s.Qb(9,"ion-text",2),s.rc(10),s.Pb(),s.Pb(),s.Mb(11,"br"),s.Mb(12,"br"),s.Mb(13,"br"),s.Mb(14,"br"),s.Mb(15,"br"),s.Qb(16,"ion-item",3),s.Qb(17,"ion-label",4),s.rc(18,"\u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430"),s.Pb(),s.Qb(19,"ion-select",5),s.Yb("ngModelChange",(function(e){return t.delivery=e}))("ionChange",(function(){return t.updatePrice()})),s.Qb(20,"ion-select-option"),s.rc(21,"\u041a\u0443\u0440\u044c\u0435\u0440\u043e\u043c"),s.Pb(),s.Qb(22,"ion-select-option"),s.rc(23,"\u0412 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a"),s.Pb(),s.Qb(24,"ion-select-option"),s.rc(25,"\u0414\u043b\u044f \u0443\u0447\u0430\u0449\u0438\u0445\u0441\u044f(\u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e)"),s.Pb(),s.Qb(26,"ion-select-option"),s.rc(27,"\u0417\u0430\u0431\u0440\u0430\u0442\u044c \u0432 \u043e\u0442\u0434\u0435\u043b\u0435\u043d\u0438\u0438"),s.Pb(),s.Pb(),s.Pb(),s.qc(28,f,14,2,"div",6),s.qc(29,m,4,0,"ion-item",7),s.qc(30,C,3,2,"div",8),s.Pb()),2&e&&(s.Ab(10),s.tc("",t.storage.priceFull$.value," RUB"),s.Ab(9),s.dc("ngModel",t.delivery),s.Ab(9),s.dc("ngIf","\u041a\u0443\u0440\u044c\u0435\u0440\u043e\u043c"==t.delivery||"\u0412 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a"==t.delivery||"\u0414\u043b\u044f \u0443\u0447\u0430\u0449\u0438\u0445\u0441\u044f"==t.delivery),s.Ab(1),s.dc("ngIf","\u0417\u0430\u0431\u0440\u0430\u0442\u044c \u0432 \u043e\u0442\u0434\u0435\u043b\u0435\u043d\u0438\u0438"==t.delivery&&1e3>t.storage.priceFull$.value),s.Ab(1),s.dc("ngIf",""!=t.delivery))},directives:[o.i,o.n,o.v,o.m,o.t,o.E,r.f,r.g,o.u,i.j,o.l,o.F,o.f,i.h,h],styles:["ion-content[_ngcontent-%COMP%]{--offset-bottom:auto!important;--overflow:hidden;overflow:auto;height:100%;width:100%;position:absolute;top:0}ion-content[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.paypalDis[_ngcontent-%COMP%]{opacity:.4;pointer-events:none;touch-action:none}"]}),e})()}];let S=(()=>{class e{}return e.\u0275mod=s.Jb({type:e}),e.\u0275inj=s.Ib({factory:function(t){return new(t||e)},imports:[[g.j.forChild(O)],g.j]}),e})(),w=(()=>{class e{}return e.\u0275mod=s.Jb({type:e}),e.\u0275inj=s.Ib({factory:function(t){return new(t||e)},providers:[v.a],imports:[[i.b,r.d,o.y,P.b,u,S,a.a.forRoot({name:"__mydb",driverOrder:["localstorage"]})]]}),e})()}}]);